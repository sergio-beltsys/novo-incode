<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta https-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="shortcut icon" href="../imagens/Incode02.ico" />
  <link href="../styles/reset.css" rel="stylesheet" type="text/css" />
  <link href="../styles/bootstrap.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="../styles/style.css" />
  <link rel="stylesheet" href="../styles/padraoCliente.css" />
  <script type="text/javascript" src="../js/scripts.js"></script>
  <script type="text/javascript" src="../js/sweet.js"></script>
  <script type="text/javascript" src="../js/bootstrap.bundle.min.js"></script>
  <title>Incode</title>
</HEAD>
<body>
    <section class="d-flex justify-content-between header">
        <div class="ajust-width">
          <a href="../lista_rotas.htm">
            <img class="logo-cliente" src="../Imagens/logo_itau.png" alt="Logo Cliente" />
          </a>
        </div>
        <div>
          <h1>Incode®- Documentação de Sistemas</h1>
        </div>
        <div class="text-end p-2 ajust-width">
          <a href="http://www.beltsysplus.com.br">
            <img class="logo-header p-2" src="../Imagens/logo-incode.png" alt="Logo Incode" /> 
          </a>
        </div>
      </section>
<br>
<div class="container-sm">
  <table class="table">
    <caption>Características Função Universal2:&nbsp;:&nbsp;parserMainframeGRBE (Univers2.cpp)</caption>
    <tbody>
      <tr>
        <td class="w-50">Linha de início: 1275</td>
      </tr>
      <tr>
        <td class="w-50">Linha final: 1488</td>
      </tr>
      <tr>
        <td>
          <table class="table">
            <thead>
              <tr>
                <td class="w-50">Nome</td>
                <td class="w-50">Tipo</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="w-50">node</td>
                <td class="w-50">CXMLNode &</td>
              </tr>
            </tbody>
          </table>
        </td>
      </tr>
    </tbody>
  </table>
</div>
<div class="container">
  <div class="table-responsive">
    <table class="table no-hover tbl-layout-fixo">
      <caption>Diagrama de Sequência</caption>
      <tbody class="text-center">
        <tr>
          <td class="text-center">
            <svg onclick="zoom(imgDiagramaSequencia, 100);" xmlns="http://www.w3.org/2000/svg" width="22" height="22" fill="currentColor" class="pointer" viewBox="0 0 16 16">
              <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM8.5 4.5a.5.5 0 0 0-1 0v3h-3a.5.5 0 0 0 0 1h3v3a.5.5 0 0 0 1 0v-3h3a.5.5 0 0 0 0-1h-3v-3z"/>
            </svg>
            <svg onclick="zoom(imgDiagramaSequencia, -100);" xmlns="http://www.w3.org/2000/svg" width="22" height="22" fill="currentColor" class="pointer" viewBox="0 0 16 16">
              <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM4.5 7.5a.5.5 0 0 0 0 1h7a.5.5 0 0 0 0-1h-7z"/>
            </svg>
          </td>
        </tr>
        <tr>
          <td class="td-scroll">

<img id="imgDiagramaSequencia" src="../imagens/Diagrama-Seq-Itau.sis-itau-wn-app-servidor-build-D-ProjInternet-bankline-univers2--Universal2¢¢parserMainframeGRBE.jpg">
          </td>
        </tr>
      </tbody>
  </div>
</div>
<div class="container w-75">
    <div class="table-responsive">
      <table class="table no-hover tbl-layout-fixo">
        <caption>Fonte</caption>
        <tbody class="text-start">
          <tr>
            <td class="td-scroll">      
              Universal2:&nbsp;:&nbsp;parserMainframeGRBE                         
  void&nbsp;Universal2:&nbsp;:&nbsp;parserMainframeGRBE&nbsp;(CXMLNode&nbsp;&&nbsp;node) <br>
  { <br>
  CXMLNodenodeChild; <br>
  CXMLNodenodeValorizacao; <br>
  StringnomeChild, <br>
  codigoTrn, <br>
  opcaoTrn, <br>
  dadosMainframe, <br>
  estatisticaGRBE, <br>
  tamDadosMainframe, <br>
  passoGRBE; <br>
  StringListlistaValores; <br>
  charptAgencia&nbsp;[10], <br>
  ptNroSerie&nbsp;[10], <br>
  ptInstituicao&nbsp;[10]; <br>
  &nbsp <br>
  #ifdef&nbsp;_DEBUG <br>
  geraAplBkl&nbsp;(5,&nbsp;"&nbsp;Interacao&nbsp;Mainframe&nbsp;GRBE",&nbsp;_interacaoAtual); <br>
  #endif <br>
  node.getAttribute&nbsp;("codigoGRBE",&nbsp;codigoTrn); <br>
  _docBKLXML.alteraValorAtributo(TAG_UNIVERSAL2,&nbsp;ATRIB_ULTIMO_TRANCODE,&nbsp;codigoTrn); <br>
  node.getAttribute&nbsp;("estatisticaGRBE",&nbsp;estatisticaGRBE); <br>
  node.getAttribute&nbsp;("passoGRBE",&nbsp;passoGRBE); <br>
  node.getAttribute&nbsp;("opcaoTrn",&nbsp;opcaoTrn); <br>
  &nbsp <br>
  //&nbsp;Percorre&nbsp;todos&nbsp;os&nbsp;nos&nbsp;filhos <br>
  for&nbsp;(node.child&nbsp;(nodeChild); <br>
  !nodeChild.isNull(); <br>
  nodeChild.nextSibling()) <br>
  { <br>
  nodeChild.getNodeName&nbsp;(nomeChild); <br>
  &nbsp <br>
  switch&nbsp;(nomeParaCodigo&nbsp;(nomeChild)) <br>
  { <br>
  case&nbsp;VALORIZACAO: <br>
  parserValorizacaoPesquisa&nbsp;(nodeChild,&nbsp;nodeValorizacao); <br>
  break; <br>
  &nbsp <br>
  case&nbsp;LISTA_OPERACAO: <br>
  parserListaOperacao&nbsp;(nodeChild); <br>
  break; <br>
  &nbsp <br>
  default: <br>
  throw&nbsp;CErroTagInvalida&nbsp;("Mainframe",&nbsp;nomeChild); <br>
  } <br>
  } <br>
  &nbsp <br>
  if&nbsp;(nodeValorizacao.isNull()) <br>
  { <br>
  throw&nbsp;&nbsp;CErroXMLChild&nbsp;("Valorizacao"); <br>
  } <br>
  &nbsp <br>
  parserValorizacao&nbsp;(nodeValorizacao,&nbsp;listaValores); <br>
  &nbsp <br>
  #ifdef&nbsp;_DEBUG <br>
  //&nbsp;Simulador&nbsp;de&nbsp;transações&nbsp;GRBE <br>
  if&nbsp;(_codPrograma&nbsp;==&nbsp;"WNSI") <br>
  { <br>
  _docBKLXML.obtemValorAtributo&nbsp;(TAG_UNIVERSAL2,&nbsp;TAG_ATRIBUTOS,&nbsp;"WNSI_transacao",&nbsp;codigoTrn); <br>
  _docBKLXML.obtemValorAtributo&nbsp;(TAG_UNIVERSAL2,&nbsp;TAG_ATRIBUTOS,&nbsp;"WNSI_complemento",&nbsp;passoGRBE); <br>
  _docBKLXML.obtemValorAtributo&nbsp;(TAG_UNIVERSAL2,&nbsp;TAG_ATRIBUTOS,&nbsp;"WNSI_opcao",&nbsp;opcaoTrn); <br>
  } <br>
  #endif <br>
  &nbsp <br>
  for&nbsp;(int&nbsp;i&nbsp;=&nbsp;0;&nbsp;i&nbsp;<&nbsp;listaValores.length();&nbsp;i++) <br>
  { <br>
  <span style="color: #000080; font-weight: bold"> dadosMainframe&nbsp;+=&nbsp;listaValores[i];</span> <br>
  <span style="color: #000080; font-weight: bold"> dadosMainframe&nbsp;+=&nbsp;"@";</span> <br>
  } <br>
  &nbsp <br>
  strcpy&nbsp;(ptAgencia,&nbsp;"...."); <br>
  strcpy&nbsp;(ptNroSerie,&nbsp;"....."); <br>
  strcpy&nbsp;(ptInstituicao,&nbsp;"......"); <br>
  &nbsp <br>
  if&nbsp;(_novoCodigoGRBE&nbsp;!=&nbsp;"") <br>
  { <br>
  codigoTrn&nbsp;=&nbsp;_novoCodigoGRBE; <br>
  _novoCodigoGRBE&nbsp;=&nbsp;""; <br>
  } <br>
  _docBKLXML.alteraValorAtributo(TAG_UNIVERSAL2,&nbsp;ATRIB_ULTIMO_TRANCODE,&nbsp;codigoTrn); <br>
  &nbsp <br>
  if&nbsp;(&nbsp;!codigoTrn.length()&nbsp;) <br>
  { <br>
  _docBKLXML.obtemValorAtributo&nbsp;(TAG_UNIVERSAL2,&nbsp;TAG_ATRIBUTOS,&nbsp;"codigoMainframeGRBE",&nbsp;codigoTrn); <br>
  } <br>
  codigoTrn.fillLeft('0',&nbsp;3); <br>
  &nbsp <br>
  //_tipoResposta&nbsp;=&nbsp;'2'; <br>
  &nbsp <br>
  if&nbsp;(&nbsp;_trocouResposta&nbsp;) <br>
  { <br>
  BIHabilitaGeracaoLogOperacoes&nbsp;(varPrograma); <br>
  } <br>
  &nbsp <br>
  /* <br>
  Header&nbsp;GRBE <br>
  headerGRBE[8], <br>
  Instituicao[6],//&nbsp;Instituicao&nbsp;ou&nbsp;banco <br>
  Agencia[4],//&nbsp;Agencia&nbsp;destino <br>
  TempoUltTrn[3],//&nbsp;Tempo&nbsp;da&nbsp;ultima&nbsp;transacao <br>
  CodigoTrn[3],//&nbsp;Codigo&nbsp;da&nbsp;transacao <br>
  NumSerieTerm[5],//&nbsp;Numero&nbsp;de&nbsp;serie&nbsp;do&nbsp;terminal <br>
  Formato[2],//&nbsp;Formato <br>
  Header&nbsp;Aplicação <br>
  CtrlResp,//&nbsp;Controle&nbsp;de&nbsp;resposta <br>
  Autorizacao,//&nbsp;Autorização <br>
  CP2CodTrn[4],//&nbsp;Cod&nbsp;da&nbsp;Transacao <br>
  OpTrn[5],//&nbsp;Opção&nbsp;da&nbsp;transação <br>
  CHVEmis[7],//&nbsp;Chave&nbsp;do&nbsp;emissor <br>
  CHVProc[7],//&nbsp;Chave&nbsp;do&nbsp;processador <br>
  CPUProc[4],//&nbsp;CPU&nbsp;do&nbsp;processador <br>
  TamParteVar[4];//&nbsp;Tamanho&nbsp;da&nbsp;parte&nbsp;variavel <br>
  */ <br>
  &nbsp <br>
  <span style="color: red; font-weight: bold"> _inputMainframe&nbsp;=&nbsp;"........";&nbsp;//.fillRight('.',8);</span> <br>
  <span style="color: red; font-weight: bold"> _inputMainframe&nbsp;+=&nbsp;ptInstituicao;</span> <br>
  if&nbsp;(strlen(ptAgencia)) <br>
  { <br>
  <span style="color: red; font-weight: bold"> _inputMainframe&nbsp;+=&nbsp;ptAgencia;</span> <br>
  } <br>
  else <br>
  { <br>
  String&nbsp;mensErroGrbe&nbsp;=&nbsp;"Agencia&nbsp;não&nbsp;encontrada&nbsp;no&nbsp;arq.&nbsp;'"; <br>
  mensErroGrbe&nbsp;+=&nbsp;ARQ_CONF_GTI; <br>
  mensErroGrbe&nbsp;+=&nbsp;"'"; <br>
  &nbsp <br>
  <span style="color: red; font-weight: bold"> _inputMainframe&nbsp;+=&nbsp;"&nbsp;&nbsp;&nbsp;&nbsp;";</span> <br>
  BIGeraErro&nbsp;("Univers2",&nbsp;777,&nbsp;mensErroGrbe); <br>
  } <br>
  <span style="color: red; font-weight: bold"> _inputMainframe&nbsp;+=&nbsp;"001";</span> <br>
  <span style="color: red; font-weight: bold"> _inputMainframe&nbsp;+=&nbsp;codigoTrn;</span> <br>
  <span style="color: red; font-weight: bold"> _inputMainframe&nbsp;+=&nbsp;ptNroSerie;</span> <br>
  <span style="color: red; font-weight: bold"> _inputMainframe&nbsp;+=&nbsp;"00";</span> <br>
  <span style="color: red; font-weight: bold"> _inputMainframe&nbsp;+=&nbsp;"A";</span> <br>
  &nbsp <br>
  //&nbsp;autorizacao&nbsp;=&nbsp;passo <br>
  #ifdef&nbsp;_DEBUG <br>
  <span style="color: red; font-weight: bold"> _inputMainframe&nbsp;+=&nbsp;passoGRBE;</span> <br>
  if&nbsp;(_codPrograma&nbsp;!=&nbsp;"WNSI") <br>
  { <br>
  <span style="color: red; font-weight: bold"> _inputMainframe&nbsp;+=&nbsp;"0000";</span> <br>
  } <br>
  #else <br>
  if&nbsp;(&nbsp;passoGRBE.length()&nbsp;==&nbsp;1&nbsp;) <br>
  { <br>
  <span style="color: red; font-weight: bold"> _inputMainframe&nbsp;+=&nbsp;passoGRBE;</span> <br>
  } <br>
  else <br>
  { <br>
  <span style="color: red; font-weight: bold"> _inputMainframe&nbsp;+=&nbsp;"0";</span> <br>
  } <br>
  &nbsp <br>
  <span style="color: red; font-weight: bold"> _inputMainframe&nbsp;+=&nbsp;"0000";</span> <br>
  #endif <br>
  //&nbsp;Verifica&nbsp;se&nbsp;passou&nbsp;pela&nbsp;regra&nbsp;TrocaOpcaoGRBE <br>
  if&nbsp;(_novaOpcaoGRBE&nbsp;!=&nbsp;"") <br>
  { <br>
  opcaoTrn.atribString&nbsp;(_novaOpcaoGRBE,&nbsp;5); <br>
  _novaOpcaoGRBE&nbsp;=&nbsp;""; <br>
  } <br>
  if(opcaoTrn&nbsp;!=&nbsp;"") <br>
  { <br>
  #ifdef&nbsp;_DEBUG <br>
  if&nbsp;(!memcmp(_dadosLogon.agContaOperacao,&nbsp;"3400",&nbsp;4)&nbsp;) <br>
  #else <br>
  if&nbsp;(!memcmp(_dadosLogon.agContaOperacao,&nbsp;"3433",&nbsp;4)&nbsp;) <br>
  #endif <br>
  { <br>
  opcaoTrn&nbsp;=&nbsp;"JCS&nbsp;&nbsp;"; <br>
  } <br>
  &nbsp <br>
  opcaoTrn.fillRight('&nbsp;',&nbsp;5); <br>
  <span style="color: red; font-weight: bold"> _inputMainframe&nbsp;+=&nbsp;opcaoTrn;</span> <br>
  } <br>
  else <br>
  { <br>
  <span style="color: red; font-weight: bold"> _inputMainframe&nbsp;+=&nbsp;"CS&nbsp;&nbsp;&nbsp;";</span> <br>
  } <br>
  &nbsp <br>
  <span style="color: red; font-weight: bold"> _inputMainframe&nbsp;+=&nbsp;"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";</span> <br>
  <span style="color: red; font-weight: bold"> _inputMainframe&nbsp;+=&nbsp;_idBkl._tipoUsuario;</span> <br>
  <span style="color: red; font-weight: bold"> _inputMainframe&nbsp;+=&nbsp;"0000001";</span> <br>
  <span style="color: red; font-weight: bold"> _inputMainframe&nbsp;+=&nbsp;"ER1&nbsp;";</span> <br>
  &nbsp <br>
  if&nbsp;(estatisticaGRBE&nbsp;==&nbsp;"S") <br>
  { <br>
  Stringmodulo, <br>
  opcaoMenu, <br>
  trn; <br>
  &nbsp <br>
  _docBKLXML.obtemValorAtributo&nbsp;(TAG_UNIVERSAL2,&nbsp;TAG_ATRIBUTOS,&nbsp;"estatistica_modulo",&nbsp;modulo); <br>
  _docBKLXML.obtemValorAtributo&nbsp;(TAG_UNIVERSAL2,&nbsp;TAG_ATRIBUTOS,&nbsp;"estatistica_tipo",&nbsp;opcaoMenu); <br>
  _docBKLXML.obtemValorAtributo&nbsp;(TAG_UNIVERSAL2,&nbsp;TAG_ATRIBUTOS,&nbsp;"estatistica_trn",&nbsp;trn); <br>
  &nbsp <br>
  <span style="color: #000080; font-weight: bold"> dadosMainframe&nbsp;+=&nbsp;">7D01@";</span> <br>
  <span style="color: #000080; font-weight: bold"> dadosMainframe&nbsp;+=&nbsp;_idBkl._produto;</span> <br>
  <span style="color: #000080; font-weight: bold"> dadosMainframe&nbsp;+=&nbsp;_idBkl.getCodigoAcesso();</span> <br>
  <span style="color: #000080; font-weight: bold"> dadosMainframe&nbsp;+=&nbsp;modulo;</span> <br>
  <span style="color: #000080; font-weight: bold"> dadosMainframe&nbsp;+=&nbsp;trn;</span> <br>
  <span style="color: #000080; font-weight: bold"> dadosMainframe&nbsp;+=&nbsp;opcaoMenu;</span> <br>
  <span style="color: #000080; font-weight: bold"> dadosMainframe&nbsp;+=&nbsp;"@^";</span> <br>
  } <br>
  else <br>
  { <br>
  <span style="color: #000080; font-weight: bold"> dadosMainframe&nbsp;+=&nbsp;"^";&nbsp;//&nbsp;fim&nbsp;da&nbsp;mensagem</span> <br>
  } <br>
  &nbsp <br>
  tamDadosMainframe&nbsp;=&nbsp;dadosMainframe.length(); <br>
  tamDadosMainframe.fillLeft('0',&nbsp;4); <br>
  &nbsp <br>
  <span style="color: red; font-weight: bold"> _inputMainframe&nbsp;+=&nbsp;tamDadosMainframe;</span> <br>
  <span style="color: red; font-weight: bold"> _inputMainframe&nbsp;+=&nbsp;dadosMainframe;</span> <br>
  &nbsp <br>
  } <br>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
<div class="container">
  <div class="table-responsive">
    <table class="table no-hover tbl-layout-fixo">
      <caption>Fluxo</caption>
      <tbody class="text-center">
        <tr>
          <td class="text-center">
            <svg onclick="zoom(imgFluxoMetodo, 100);" xmlns="http://www.w3.org/2000/svg" width="22" height="22" fill="currentColor" class="pointer" viewBox="0 0 16 16">
              <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM8.5 4.5a.5.5 0 0 0-1 0v3h-3a.5.5 0 0 0 0 1h3v3a.5.5 0 0 0 1 0v-3h3a.5.5 0 0 0 0-1h-3v-3z"/>
            </svg>
            <svg onclick="zoom(imgFluxoMetodo, -100);" xmlns="http://www.w3.org/2000/svg" width="22" height="22" fill="currentColor" class="pointer" viewBox="0 0 16 16">
              <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM4.5 7.5a.5.5 0 0 0 0 1h7a.5.5 0 0 0 0-1h-7z"/>
            </svg>
          </td>
        </tr>
        <tr>
          <td class="td-scroll">

            <img id="imgFluxoMetodo" src="../imagens/FluxoMetodo-Itau.sis-itau-wn-app-servidor-build-D-ProjInternet-bankline-univers2--Universal2¢¢parserMainframeGRBE.jpg">
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>
<br><br><br>
<div class="container-fluid">
  <div class="table-responsive">
    <table class="table">
      <tbody>
        <tr>
          <td><img src="../imagens/bitmap/fluxo0.bmp"  width=36 height=24>Função analisada</td>
          <td><img src="../imagens/bitmap/fluxo13.bmp" width=36 height=24>Função chamada</td>
          <td><img src="../imagens/bitmap/fluxo1189.bmp" width=36 height=24>Acesso a Banco de Dados</td>
          <td><img src="../imagens/bitmap/fluxo21.bmp" width=36 height=24>
            Condição/Ciclo :...(F) Condição Falsa /...(T) Condição Verdadeira /...(W) Ciclo</td>
        </tr>
      </tbody>
    </table>
  </div>
</div>
